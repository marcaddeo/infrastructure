apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../base/rancher
  - ../base/pocket-id
patches:
  - path: rancher.yaml
    target:
      kind: HelmRelease
  - path: pocket-id.yaml
    target:
      kind: HelmRelease
replacements:
  - source:
      kind: Secret
      name: pocket-id-maxmind-license-key
      namespace: pocket-id-system
    targets:
      - select:
          name: pocket-id
          kind: HelmRelease
        fieldPaths:
          - spec.values.maxmindLicenseKey
